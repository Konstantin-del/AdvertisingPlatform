# Advertising Platform API

Веб-сервис для подбора рекламных площадок по локациям.

## Описание

Сервис позволяет загружать данные о рекламных площадках из файла и быстро находить подходящие площадки для конкретных локаций с учетом иерархии локаций.

## API Endpoints

### 1. Загрузка рекламных площадок из файла

**POST** `/api/AdPlatform/upload`

Загружает данные о рекламных площадках из текстового файла. Полностью перезаписывает существующие данные.

**Параметры:**
- `file` (IFormFile) - текстовый файл с данными о рекламных площадках

**Формат файла:**
```
Название площадки:локация1,локация2,локация3
```

**Пример:**
```
Яндекс.Директ:/ru
Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
Крутая реклама:/ru/svrd
```

**Ответ:**
```json
{
  "message": "Рекламные площадки успешно загружены"
}
```

### 2. Поиск рекламных площадок по локации

**GET** `/api/AdPlatform/search?location={location}`

**GET** `/api/AdPlatform/search/{location}`

Находит все рекламные площадки, которые действуют в указанной локации, включая площадки из родительских локаций.

**Параметры:**
- `location` (string) - локация для поиска (например: `/ru/msk`)

**Пример запроса:**
```
GET /api/AdPlatform/search?location=/ru/msk
```

**Ответ:**
```json
{
  "location": "/ru/msk",
  "platforms": [
    "Газета уральских москвичей",
    "Яндекс.Директ"
  ],
  "count": 2
}
```

## Логика работы с локациями

Локации имеют иерархическую структуру. Например:
- `/ru` - глобальная локация для всей России
- `/ru/msk` - локация для Москвы
- `/ru/svrd/ekb` - локация для Екатеринбурга

При поиске площадок для локации `/ru/svrd/ekb` будут найдены площадки, которые действуют в:
- `/ru/svrd/ekb` (точное совпадение)
- `/ru/svrd` (родительская локация)
- `/ru` (глобальная локация)

## Запуск приложения

1. Убедитесь, что у вас установлен .NET 9.0
2. Перейдите в папку `AdvertisingPlatform.Presentation`
3. Запустите приложение:
   ```bash
   dotnet run
   ```
4. Откройте браузер и перейдите по адресу `https://localhost:7xxx` (порт будет показан в консоли)
5. Для тестирования API используйте Swagger UI по адресу `https://localhost:7xxx/swagger`

## Тестирование

1. Загрузите тестовый файл `test_data.txt` через endpoint `/api/AdPlatform/upload`
2. Протестируйте поиск площадок для различных локаций:
   - `/ru` - должна вернуть только Яндекс.Директ и ВКонтакте
   - `/ru/msk` - должна вернуть Яндекс.Директ, ВКонтакте, Газета уральских москвичей, Google Ads, Facebook, Instagram
   - `/ru/svrd/revda` - должна вернуть Яндекс.Директ, ВКонтакте, Крутая реклама, Ревдинский рабочий

## Особенности реализации

- Данные хранятся в оперативной памяти для максимальной скорости поиска
- Используется `ConcurrentDictionary` для thread-safe операций
- Сервис зарегистрирован как Singleton для оптимальной производительности
- Обработка некорректных данных - некорректные строки в файле игнорируются
- Подробное логирование всех операций
